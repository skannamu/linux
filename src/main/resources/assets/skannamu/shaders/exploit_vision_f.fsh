#version 150

uniform sampler2D Sampler0;
uniform float Time;
uniform vec2 ScreenSize;

in vec2 texCoord;

out vec4 fragColor;

vec3 grayscale(vec3 color) {
    float avg = dot(color, vec3(0.299, 0.587, 0.114));
    return vec3(avg);
}

void main() {
    float timeEffect = sin(Time * 0.5) * 0.003;

    vec2 center = vec2(0.5, 0.5);
    float dist = distance(texCoord, center);
    float distortion = timeEffect * dist * 2.0;

    vec2 redCoord = texCoord + distortion * vec2(1.0, 1.0);
    vec2 greenCoord = texCoord;
    vec2 blueCoord = texCoord - distortion * vec2(1.0, 1.0);

    float r = texture(Sampler0, redCoord).r;
    float g = texture(Sampler0, greenCoord).g;
    float b = texture(Sampler0, blueCoord).b;

    vec3 color = vec3(r, g, b);

    color = grayscale(color);
    color *= vec3(0.9, 1.1, 1.2);

    fragColor = vec4(color, 1.0);
}
